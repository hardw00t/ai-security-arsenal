{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://android-pentest.schema/finding.json",
  "title": "Android Security Finding",
  "description": "Schema for standardized Android penetration testing findings",
  "type": "object",
  "required": ["id", "title", "severity", "category", "description"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier for the finding",
      "pattern": "^[A-Z0-9]{6,12}$",
      "examples": ["VULN001", "AUTH001", "CRYPTO001"]
    },
    "title": {
      "type": "string",
      "description": "Short descriptive title",
      "minLength": 10,
      "maxLength": 150
    },
    "severity": {
      "type": "string",
      "description": "Finding severity level",
      "enum": ["critical", "high", "medium", "low", "info"]
    },
    "cvss": {
      "type": "object",
      "description": "CVSS 3.1 scoring",
      "properties": {
        "score": {
          "type": "number",
          "minimum": 0,
          "maximum": 10
        },
        "vector": {
          "type": "string",
          "pattern": "^CVSS:3\\.1/.*"
        },
        "attack_vector": {
          "type": "string",
          "enum": ["Network", "Adjacent", "Local", "Physical"]
        },
        "attack_complexity": {
          "type": "string",
          "enum": ["Low", "High"]
        },
        "privileges_required": {
          "type": "string",
          "enum": ["None", "Low", "High"]
        },
        "user_interaction": {
          "type": "string",
          "enum": ["None", "Required"]
        },
        "scope": {
          "type": "string",
          "enum": ["Unchanged", "Changed"]
        },
        "confidentiality_impact": {
          "type": "string",
          "enum": ["None", "Low", "High"]
        },
        "integrity_impact": {
          "type": "string",
          "enum": ["None", "Low", "High"]
        },
        "availability_impact": {
          "type": "string",
          "enum": ["None", "Low", "High"]
        }
      }
    },
    "owasp_risk": {
      "type": "object",
      "description": "OWASP Risk Rating",
      "properties": {
        "likelihood": {
          "type": "string",
          "enum": ["Low", "Medium", "High"]
        },
        "impact": {
          "type": "string",
          "enum": ["Low", "Medium", "High"]
        },
        "risk_level": {
          "type": "string",
          "enum": ["Note", "Low", "Medium", "High", "Critical"]
        }
      }
    },
    "category": {
      "type": "string",
      "description": "MASVS category",
      "enum": [
        "MASVS-STORAGE",
        "MASVS-CRYPTO",
        "MASVS-AUTH",
        "MASVS-NETWORK",
        "MASVS-PLATFORM",
        "MASVS-CODE",
        "MASVS-RESILIENCE",
        "MASVS-PRIVACY"
      ]
    },
    "cwe_ids": {
      "type": "array",
      "description": "Related CWE identifiers",
      "items": {
        "type": "string",
        "pattern": "^CWE-\\d+$"
      }
    },
    "mastg_ids": {
      "type": "array",
      "description": "Related MASTG test case IDs",
      "items": {
        "type": "string",
        "pattern": "^MASTG-TEST-\\d{4}$"
      }
    },
    "description": {
      "type": "string",
      "description": "Detailed description of the vulnerability",
      "minLength": 50
    },
    "technical_details": {
      "type": "string",
      "description": "Technical explanation for security professionals"
    },
    "impact": {
      "type": "object",
      "description": "Impact assessment",
      "properties": {
        "confidentiality": {
          "type": "string",
          "description": "Impact on confidentiality"
        },
        "integrity": {
          "type": "string",
          "description": "Impact on integrity"
        },
        "availability": {
          "type": "string",
          "description": "Impact on availability"
        },
        "business_impact": {
          "type": "string",
          "description": "Business-level impact description"
        }
      }
    },
    "affected_component": {
      "type": "string",
      "description": "Affected app component or file"
    },
    "affected_versions": {
      "type": "array",
      "description": "Affected application versions",
      "items": {
        "type": "string"
      }
    },
    "reproduction_steps": {
      "type": "array",
      "description": "Step-by-step reproduction instructions",
      "items": {
        "type": "object",
        "properties": {
          "step_number": {"type": "integer"},
          "description": {"type": "string"},
          "command": {"type": "string"},
          "expected_result": {"type": "string"},
          "screenshot": {"type": "string"}
        },
        "required": ["step_number", "description"]
      }
    },
    "evidence": {
      "type": "array",
      "description": "Supporting evidence",
      "items": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": ["screenshot", "logcat", "code", "request", "response", "frida_output", "file", "database"]
          },
          "description": {"type": "string"},
          "path": {"type": "string"},
          "content": {"type": "string"},
          "timestamp": {"type": "string", "format": "date-time"}
        },
        "required": ["type", "description"]
      }
    },
    "remediation": {
      "type": "object",
      "description": "Remediation guidance",
      "properties": {
        "summary": {
          "type": "string",
          "description": "Brief remediation summary"
        },
        "detailed_steps": {
          "type": "array",
          "items": {"type": "string"}
        },
        "code_example": {
          "type": "object",
          "properties": {
            "language": {"type": "string"},
            "vulnerable_code": {"type": "string"},
            "secure_code": {"type": "string"}
          }
        },
        "effort": {
          "type": "string",
          "enum": ["Low", "Medium", "High"]
        },
        "priority": {
          "type": "string",
          "enum": ["Immediate", "Short-term", "Long-term"]
        }
      }
    },
    "references": {
      "type": "array",
      "description": "External references",
      "items": {
        "type": "object",
        "properties": {
          "title": {"type": "string"},
          "url": {"type": "string", "format": "uri"}
        },
        "required": ["title", "url"]
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata",
      "properties": {
        "discovered_date": {"type": "string", "format": "date-time"},
        "discovered_by": {"type": "string"},
        "verified": {"type": "boolean"},
        "verified_by": {"type": "string"},
        "false_positive": {"type": "boolean"},
        "status": {
          "type": "string",
          "enum": ["new", "confirmed", "in_progress", "resolved", "accepted_risk", "false_positive"]
        },
        "tags": {
          "type": "array",
          "items": {"type": "string"}
        }
      }
    }
  }
}
